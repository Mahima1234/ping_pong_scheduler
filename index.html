<!DOCTYPE html>

<html>
<head >
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<script src='https://code.jquery.com/jquery-3.1.0.min.js'></script>
<audio id="audio" src="http://soundbible.com/mp3/Buzzer-SoundBible.com-188422102.mp3"></audio>
<audio id="audio2" src="http://soundbible.com/mp3/old-fashioned-door-bell-daniel_simon.mp3"></audio>
<link rel="stylesheet" href="style.css">
<script src="master.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.1.2/firebase.js"></script>
<script>
//initializeFir
var config = {
  apiKey: "AIzaSyDDrze4WIGeBYuyl_Y7RhmISYm_zGUz4OU",
  authDomain: "ping-pong-scheduler-1dd4f.firebaseapp.com",
  databaseURL: "https://ping-pong-scheduler-1dd4f.firebaseio.com",
  projectId: "ping-pong-scheduler-1dd4f",
  storageBucket: "ping-pong-scheduler-1dd4f.appspot.com",
  messagingSenderId: "290287324381"
};
firebase.initializeApp(config);
</script>
<script>
  var database = firebase.database();
  var timeref =database.ref('details/');
  var hour,minutes,secs

function onLoad(){
   addtodatabase(0,0,0);
}

  function addtodatabase(h,m,t){
    database.ref('details/').set({
    hour: (d.getHours()),
    min: (d.getMinutes()),
    time:t
  })
  }
  function resetTimer()
  {
    document.getElementById('timer3').innerHTML='30:00';
    document.getElementById('timer2').innerHTML='20:00';
    document.getElementById('timer1').innerHTML='10:00';
  }
  var myStop;
  function stop(){
   clearInterval(countSec);
   clearTimeout(myStop);
   hideTimerSections(["set1","set2","set3","stop"]);
   showTimerSections(["button1","button2","button3","para","select"])
   resetTimer();
    $("#button1").bind("click", startTenMinuteTimer);
    $("#button2").bind("click", startTwentyMinuteTimer);
    $("#button3").bind("click", startThirtyMinuteTimer);
     hideTimerWarning();
     addtodatabase(0,0,0);
  }
   var getCurrentTime= function(){
   var d= new Date();
    var h = (d.getHours());
    var m = (d.getMinutes());
    hour = h;
    minutes = m;

 }
  var startTenMinuteTimer= function() {
    start10()
    hideTimerSections(["button1", "button2","button3","para","select"]);
    showTimerSections(["stop","firstTimer","set1"]);
    var currentTime=getCurrentTime();
    addtodatabase(hour,minutes,10);
    myStop= setTimeout(function(){
      hideTimerSections(["stop", "set1"]);
      showTimerSections(["button1","button2","button3","para","select"]);
      addtodatabase(hour,minutes,0);
        },600000);
  };

  var startTwentyMinuteTimer=function() {
    start20()
    hideTimerSections(["button1","button2", "button3","para","select"]);
    showTimerSections(["stop","set2","secondTimer"]);
    var currentTime=getCurrentTime();
    addtodatabase(hour,minutes,20);
    myStop=setTimeout(function(){
      hideTimerSections(["stop", "set2"]);
      showTimerSections(["button1","button2","button3","para","select"]);
      addtodatabase(hour,minutes,0);
        },1200000);
  };
  var startThirtyMinuteTimer=function()  {
    start30();
    hideTimerSections(["button1", "button2","button3","para","select"]);
    showTimerSections(["stop","set3","thirdTimer"]);
    var currentTime=getCurrentTime();
    addtodatabase(hour,minutes,30);
    myStop = setTimeout(function(){
      hideTimerSections(["stop", "set3"]);
      showTimerSections(["button1","button2","button3","para","select"]);
      addtodatabase(hour,minutes,0);
    },1800000);
  }

  $("document").ready(function(){
    $("#button3").bind("click", startThirtyMinuteTimer);
  });
  $("document").ready(function(){
    $("#button2").bind("click", startTwentyMinuteTimer);
  });
  $("document").ready(function(){
    $("#button1").bind("click", startTenMinuteTimer);
  });

  function showTimerWarning(){
    $("#timerWarningMessage").show();
  }

  function hideTimerWarning(){
    $("#timerWarningMessage").hide();
  }
  function hideTimerSections(idList){
    idList.forEach(function(eachId){
      $("#" + eachId).hide();
    });
  }
  function showTimerSections(idList){
    idList.forEach(function(eachId){
      $("#" + eachId).show();
    });
  }
  </script>
</head>
<body onload="onLoad()">
<h1>Hoffman Ping Pong</h1>
<h2 id="select">Select Number of Games</h2>
<div class=column>
<section class="game">
      <button  id="button1" >1 Game</button>
        <button  id="button2" >2 Games</button>
    <button  id="button3" >3 Games</button>
</section>
<section id="para">
<p> In an effort to allow all playes reasonable time at the table, please use this
  tool to reserve the table.  This is a first come, first serve application to help
  others know when the table might be avalible.</p>
<p>
  Select the number of games you wish to play.  If you wish to play more than 3
    games (standard match set), you may select again at the end of the match if the table is still
    avalible.
  </p>
</section>
</div>
<div id="set1">
    <div id='firstTimer' class="hidden">
      <div  id="gametitle">1 Game Selected</div>
      <div id='timer1'></div>
    </div>
</div>
<div id="set2">
    <div id='secondTimer' class="hidden">
      <div id="gametitle2">2 Games Selected</div>
      <div id='timer2'></div>
    </div>
</div>
<div id="set3">
  <div id='thirdTimer' class="hidden">
    <div id="gametitle3">3 Games Selected</div>
    <div id='timer3'></div>
  </div>
</div>
<div id="center"><button onClick="stop()" id="stop" class="hidden"> End Current Game </button></div>
  <div id = 'timerWarningMessage' class="hidden" > Game is Almost Over! </div>
</body>
</html>

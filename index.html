<!DOCTYPE html>

<html>
<head>
<script src='https://code.jquery.com/jquery-3.1.0.min.js'></script>
<audio id="audio" src="http://soundbible.com/mp3/Buzzer-SoundBible.com-188422102.mp3"></audio>
<audio id="audio2" src="http://soundbible.com/mp3/old-fashioned-door-bell-daniel_simon.mp3"></audio>
<link rel="stylesheet" href="style.css">
<script src="master.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.1.2/firebase.js"></script>
<script>
//initializeFir
var config = {
  apiKey: "AIzaSyDDrze4WIGeBYuyl_Y7RhmISYm_zGUz4OU",
  authDomain: "ping-pong-scheduler-1dd4f.firebaseapp.com",
  databaseURL: "https://ping-pong-scheduler-1dd4f.firebaseio.com",
  projectId: "ping-pong-scheduler-1dd4f",
  storageBucket: "ping-pong-scheduler-1dd4f.appspot.com",
  messagingSenderId: "290287324381"
};
firebase.initializeApp(config);
</script>
<script>
function addZero(i){
  if(i<10){
    i="0"+i;
  }
  return i;
}


  var database = firebase.database();
  var timeref =database.ref('details/');
  var hour,minutes,secs
  function addtodatabase(h,m,s,t){
    database.ref('details/').set({
    hour: h,
    min: m,
    sec:s,
    time:t
  })
  }


  function resetTimer()
  {
    document.getElementById('timer3').innerHTML='30:00';
    document.getElementById('timer2').innerHTML='20:00';
    document.getElementById('timer1').innerHTML='10:00';
  }

  var myStop;
  function stop(){
   clearInterval(countSec);
   clearTimeout(myStop);
   hideTimerSections(["firstTimer", "secondTimer","thirdTimer","stop"]);
   showTimerSections(["set1","set2","set3"])
   resetTimer();
    $("#button1").bind("click", startTenMinuteTimer);
    $("#button2").bind("click", startTwentyMinuteTimer);
    $("#button3").bind("click", startThirtyMinuteTimer);
     hideTimerWarning();
     addtodatabase(0,0,0,0);
  }
   var getCurrentTime= function(){
   var d= new Date();
    var h = addZero(d.getHours());
    var m = (d.getMinutes());
    var s = addZero(d.getSeconds());
    hour = h;
    minutes = m;
    secs=s
 }
  var startTenMinuteTimer= function() {

    start10()
    hideTimerSections(["set2", "set3"]);
    showTimerSections(["stop","firstTimer"]);
    var currentTime=getCurrentTime();
    addtodatabase(hour,minutes,secs,10);

    myStop= setTimeout(function(){
      hideTimerSections(["stop", "firstTimer","secondTimer","thirdTimer"]);
      showTimerSections(["set1","set2","set3"]);
      addtodatabase(hour,minutes,secs,0);
        },600000);
  };

  var startTwentyMinuteTimer=function() {
    start20()
    hideTimerSections(["set1", "set3"]);
    showTimerSections(["stop","secondTimer"]);
    var currentTime=getCurrentTime();
    addtodatabase(hour,minutes,secs,20);

        myStop=setTimeout(function(){
          hideTimerSections(["stop", "firstTimer","secondTimer","thirdTimer"]);
          showTimerSections(["set1","set2","set3"]);
          addtodatabase(hour,minutes,secs,0);
        },1200000);
  };


  var startThirtyMinuteTimer=function()
  {
    start30();
    hideTimerSections(["set1", "set2"]);
    showTimerSections(["stop","thirdTimer"]);
    var currentTime=getCurrentTime();
    addtodatabase(hour,minutes,secs,30);

    myStop = setTimeout(function(){
      hideTimerSections(["stop", "firstTimer","secondTimer","thirdTimer"]);
      showTimerSections(["set1","set2","set3"]);
      addtodatabase(hour,minutes,secs,0);
    },1800000);
  }

  $("document").ready(function(){
    $("#button3").bind("click", startThirtyMinuteTimer);
  });
  $("document").ready(function(){
    $("#button2").bind("click", startTwentyMinuteTimer);
  });
  $("document").ready(function(){
    $("#button1").bind("click", startTenMinuteTimer);
  });

  function showTimerWarning(){
    $("#timerWarningMessage").show();
  }

  function hideTimerWarning(){
    $("#timerWarningMessage").hide();
  }
  function hideTimerSections(idList){
    idList.forEach(function(eachId){
      $("#" + eachId).hide();
    });
  }
  function showTimerSections(idList){
    idList.forEach(function(eachId){
      $("#" + eachId).show();
    });
  }
  </script>
</head>
<body>

<button onClick="stop()" id="stop" class="hidden"> Stop Game </button>
<h1>How Many Games Would You Like to Play?</h1>
    <div id="set1">
        <button  id="button1" >1 Game</button>
        <div id='firstTimer' class="hidden">
          <div id='timer1'></div>
        </div>
    </div>

    <div id="set2">
        <button  id="button2" >2 Games</button>
        <div id='secondTimer' class="hidden">
          <div id='timer2'></div>
        </div>
    </div>

    <div id="set3">
      <button  id="button3" >3 Games</button>
      <div id='thirdTimer' class="hidden">
        <div id='timer3'></div>
      </div>
    </div>

  <div id = 'timerWarningMessage' class="hidden" > Game is Almost Over! </div>
</body>
</html>
